# mails from mailman -> inbox
if (/^X-List-Administrivia: yes/)
{
	to $DEFAULT
}

# Mailing list automagic
if ( \
		/^List-Id:.*<([0-9A-Za-z_\-]+)\.(lists\.)?(.*)>/ \
)
#     if (    (/^List-Id:.*<[a-zA-Z0-9_\-]+!./) \
#          || (/^Mailing-List:.* ![a-zA-Z0-9_\-]+!-owner@/) \
#          || (/^X-list: ![a-zA-Z0-9_\-]+/) \
#          || (/^List-Id: ![a-zA-Z0-9_\-]+!./) \
#        )
    {
        LISTNAME=tolower($MATCH1)

		# convert server name from dots to hyphens
		foreach ($MATCH3) =~ /[^.]+/
		{ 
			LISTDOMAIN="${LISTDOMAIN}-${MATCH}"
		}
		LISTDOMAIN=substr($LISTDOMAIN, 1)

        DESTDIR="$DEFAULT/.ML.$LISTDOMAIN.$LISTNAME"

        `test -d $DESTDIR`
        if ( $RETURNCODE == 1 )
        {
            log "ML magic - $DESTDIR does not exist"
            #log "Creating List dir"
            #`maildirmake -f Spam ./Maildir`
        }
        else
        {
            log "ML magic - to $DESTDIR"
            to $DESTDIR
        }
    }
